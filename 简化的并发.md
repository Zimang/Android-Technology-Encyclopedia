[[Threads]]
[[Atomic Execution]]
[[Visibility]]


到目前为止，讨论的目的是重新定义并发的概念。并发不是让程序运行更快的方法。它也不是忍者程序员用来同时控制多个任务的复杂戏法。相反，程序的顺序执行才是复杂的戏法。顺序执行只是编译器编写者和硬件架构师维持的一种幻觉。并发只是对一种虚构约束的放松。

并发本身并不可怕。我们每天都在现实世界中处理它。困难的是为基于可变状态的计算机编写并发程序。这很困难，因为顺序的概念是我们推理程序的重要隐含基础。

并发是对命令式计算机语言中固有严格顺序的放松。Java用线程来实现这一点。线程按照一种与其他线程中指令执行顺序无关的顺序执行指令。开发人员使用互斥锁（mutexes）来控制线程对代码关键部分的访问，从而限制两个不同线程在该部分执行指令的方式。

今天的大多数计算机语言制造了顺序执行的幻觉。然而，在幕后，它们会激烈地重新排序、并行化和缓存以充分利用硬件。阻止这些优化使程序表现不确定的唯一因素是一个合同。正确的程序是遵守该合同的程序。

没有人说并发是容易的。但它相当简单。只需遵循合同。